(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{77:function(t,e,a){"use strict";a.r(e);var o=a(0),i=a(1);new o.a({el:"#app",mixins:[i.b],created:function(){this.getRemoteData()},data:function(){return{showAdd:!1,showEdit:!1,items:null,tdata:[],editItem:{},addItem:{},headers:[{text:"ID",align:"left",value:"id",sortable:!1},{text:"权限名称",align:"left",value:"pri_name",sortable:!1},{text:"模块名称",align:"right",value:"module_name",sortable:!1},{text:"控制器名称",align:"right",value:"controller_name",sortable:!1},{text:"方法名",align:"right",value:"action_name",sortable:!1},{text:"操作",align:"center",value:"_act",sortable:!1}]}},methods:{getRemoteData:function(){var t=this;t.$api.privilege.get().then(function(e){t.tdata=e.data,t.tdata.unshift({parent_id:0,pri_name:"顶级权限",id:0,level:0}),t.items=t.tdata.map(function(t){return t.pri_name=Array(t.level+1).join("------")+t.pri_name,t})}).catch(function(e){t.$comp.toast({text:"获取数据失败，请刷新重试.",color:"error"})})},edit:function(t){this.editItem=JSON.parse(JSON.stringify(t)),this.editItem.pri_name=this.editItem.pri_name.replace(/------/g,""),this.showEdit=!0},del:function(t){var e=this;e.$comp.confirm({title:"提示",text:"确认要删除吗?",ok:function(){e.$api.privilege.del({data:t}).then(function(a){if(0==a.code){e.$comp.toast({text:a.msg||"删除成功."});for(var o=0;o<e.tdata.length;o++)if(e.tdata[o].id==t){e.tdata.splice(o,1);break}}else e.$comp.toast({text:a.msg||"删除失败，请刷新后重试.",color:"error"})}).catch(function(t){e.$comp.toast({text:"删除失败，请刷新后重试.",color:"error"})})}})},addCommit:function(){var t=this;t.$api.privilege.add({data:t.addItem}).then(function(e){0==e.code?(t.$comp.toast({text:e.msg||"新增成功."}),t.getRemoteData(),t.closeDialog("add")):t.$comp.toast({text:e.msg||"新增失败，请刷新后重试.",color:"error"})}).catch(function(e){t.$comp.toast({text:"新增失败，请刷新后重试.",color:"error"})})},editCommit:function(){var t=this;t.$api.privilege.edit({data:t.editItem}).then(function(e){0==e.code?(t.$comp.toast({text:e.msg||"修改成功."}),t.getRemoteData(),t.closeDialog("edit")):t.$comp.toast({text:e.msg||"修改失败，请刷新后重试.",color:"error"})}).catch(function(e){t.$comp.toast({text:"修改失败，请刷新后重试.",color:"error"})})},closeDialog:function(t){var e=this;"add"==t?(e.showAdd=!1,e.$refs.addForm.reset()):"edit"==t&&(e.showEdit=!1,e.$refs.editForm.reset())}}})}},[[77,0,2,1]]]);