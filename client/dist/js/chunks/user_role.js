(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{79:function(t,e,o){"use strict";o.r(e);var a=o(0),r=o(12),i=o(1);new a.a({el:"#app",mixins:[i.b],components:{STree:r.a},created:function(){this.getRemoteData()},data:function(){return{showAdd:!1,showEdit:!1,addItem:{},editItem:{},treeData:[],selected:[],theader:[{text:"ID",align:"left",value:"id",sortable:!1},{text:"角色名称",align:"left",value:"role_name",sortable:!1},{text:"用户列表",align:"left",value:"username",sortable:!1},{text:"描述",align:"left",value:"pri_name",sortable:!1},{text:"操作",align:"center",value:"e",sortable:!1}],tdata:[]}},methods:{getRemoteData:function(){var t=this;t.$api.role.get().then(function(e){t.tdata=e.data.list,t.treeData=e.data.role}).catch(function(e){t.$comp.toast({text:"获取数据失败，请刷新重试.",color:"error"})})},edit:function(t){var e=this;e.editItem.role_name=t.role_name,e.editItem.id=t.id,e.selected=t.pri_id.split(","),e.showEdit=!0},addCommit:function(){var t=this,e={role_name:t.addItem.role_name,selected:t.$refs.treeAdd.getSelect()};t.$api.role.add({data:e}).then(function(e){0==e.code?(t.$comp.toast({text:e.msg||"新增成功."}),t.getRemoteData(),t.closeDialog("add")):t.$comp.toast({text:e.msg||"新增失败，请刷新后重试.",color:"error"})}).catch(function(e){t.$comp.toast({text:"新增失败，请刷新后重试.",color:"error"})})},editCommit:function(){var t=this,e={id:t.editItem.id,role_name:t.editItem.role_name,selected:t.$refs.treeEdit.getSelect()};t.$api.role.edit({data:e}).then(function(e){0==e.code?(t.$comp.toast({text:e.msg||"修改成功."}),t.getRemoteData(),t.closeDialog("edit")):t.$comp.toast({text:e.msg||"修改失败，请刷新后重试.",color:"error"})}).catch(function(e){t.$comp.toast({text:"修改失败，请刷新后重试.",color:"error"})})},del:function(t){var e=this;e.$comp.confirm({title:"提示",text:"确认要删除吗?",ok:function(){e.$api.role.del({data:t}).then(function(o){if(0==o.code){e.$comp.toast({text:o.msg||"删除成功."});for(var a=0;a<e.tdata.length;a++)if(e.tdata[a].id==t.id){e.tdata.splice(a,1);break}}else e.$comp.toast({text:o.msg||"删除失败，请刷新后重试.",color:"error"})}).catch(function(t){e.$comp.toast({text:"删除失败，请刷新后重试.",color:"error"})})}})},closeDialog:function(t){var e=this;"add"==t?(e.showAdd=!1,e.$refs.addForm.reset()):"edit"==t&&(e.showEdit=!1,e.$refs.editForm.reset())}}})}},[[79,0,2,1]]]);