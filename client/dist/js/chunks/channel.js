(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{55:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a(1);new n.a({el:"#app",mixins:[i.b],created:function(){this.getData()},mounted:function(){for(var t=this,e=0;e<t.tdata.length;e++){var a=t.tdata[e];t.$set(t.$refs.dTable.expanded,a.id,!0)}},methods:{getData:function(){var t=this;t.$api.channel.get().then(function(e){t.tdata=e.data,setTimeout(function(){t.calcWidth()},600)}).catch(function(e){t.$comp.toast({text:"获取失败，请重试.",color:"error"})})},onTabelResize:function(){try{this.calcWidth()}catch(t){}},calcWidth:function(){try{var t=this.$refs.td1.offsetWidth,e=this.$refs.td2.offsetWidth,a=this.$refs.td3.offsetWidth,n=this.$refs.td4.offsetWidth,i=this.$refs.td5.offsetWidth,o=this.$refs.td6.offsetWidth,s=this.$refs.td7.offsetWidth,d=this.$refs.td8.offsetWidth;this.subWidth.table.paddingLeft=t+"px",this.subWidth.td2.width=e+"px",this.subWidth.td3.width=a+"px",this.subWidth.td4.width=n+"px",this.subWidth.td5.width=i+"px",this.subWidth.td6.width=o+"px",this.subWidth.td7.width=s+"px",this.subWidth.td8.width=d+"px"}catch(t){}},remove:function(t){this.chips.splice(this.chips.indexOf(t),1),this.chips=function(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(this.chips)},addChannel:function(){var t=this;t.disabled.addChannel=!0,t.$api.channel.add({data:t.addItem}).then(function(e){0==e.code?(t.$comp.toast({text:"新增成功."}),t.getData(),t.closeDialog("add")):t.$comp.toast({text:e.msg,color:"error"}),t.disabled.addChannel=!1}).catch(function(e){t.$comp.toast({text:"新增失败，请重试.",color:"error"})})},showSales:function(t,e){var a=this;a.channel_id=t,a.channel_name=e,a.$api.channel.getSales({data:{channel_id:t}}).then(function(t){a.saliesLists=t.data.sales,a.select=t.data.child,a.showAddSales=!0}).catch(function(t){a.$comp.toast({text:"获取销售列表失败，请重试.",color:"error"})})},addSales:function(){var t=this;t.select.push(t.channel_name),t.select.push(t.channel_id),t.disabled.sales=!0,t.$api.channel.addSales({data:t.select}).then(function(e){0==e.code?(t.$comp.toast({text:"处理成功."}),t.getData(),t.closeDialog("salesAdd")):t.$comp.toast({text:e.msg,color:"error"}),t.disabled.sales=!1}).catch(function(e){t.$comp.toast({text:"新增失败，请重试.",color:"error"})})},CopyUrl:function(t){var e=t,a=!0;if(window.clipboardData)window.clipboardData.setData("Text",e);else{var n=this.CreateElementForExecCommand(e);this.SelectContent(n);try{window.netscape&&netscape.security&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),a=document.execCommand("copy",!1,null)}catch(t){a=!1}document.body.removeChild(n)}a?alert("复制成功"):alert("复制失败")},CreateElementForExecCommand:function(t){var e=document.createElement("div");return e.style.position="absolute",e.style.left="-10000px",e.style.top="-10000px",e.textContent=t,document.body.appendChild(e),e.contentEditable=!0,e},SelectContent:function(t){var e=document.createRange();e.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(e)},changeStatus:function(t){var e=this,a=this;a.$api.channel.changeStatus({data:{id:t.id,status:t.status}}).then(function(n){if(0==n.code){var i=n.data;if(t.status=i.status,t.children&&t.children.length)for(var o=t.children,s=0;s<o.length;s++)o[s].status=i.status;e.$comp.toast({text:"设置成功"})}else a.$comp.toast({text:n.msg||"设置失败，请重试.",color:"error"})}).catch(function(t){a.$comp.toast({text:t.msg||"设置失败，请重试.",color:"error"})})},showEditDig:function(t){var e=this;e.$api.channel.getChannel({data:{id:t.id}}).then(function(t){0==t.code?e.editItem=t.data:e.$comp.toast({text:t.msg||"设置失败，请重试.",color:"error"})}).catch(function(t){e.$comp.toast({text:t.msg||"设置失败，请重试.",color:"error"})}),e.showEdit=!0},editChannel:function(){var t=this;t.disabled.editChannel=!0,t.$api.channel.updateChannel({data:t.editItem}).then(function(e){0==e.code?(t.$comp.toast({text:"修改成功."}),t.getData(),t.closeDialog("edit")):t.$comp.toast({text:e.msg||"设置失败，请重试.",color:"error"}),t.disabled.editChannel=!1}).catch(function(e){t.$comp.toast({text:e.msg||"设置失败，请重试.",color:"error"}),t.disabled.sales=!1})},closeDialog:function(t){var e=this;"add"==t?(e.showAdd=!1,e.$refs.addChannelForm.reset()):"edit"==t?(e.showEdit=!1,e.$refs.channelEditForm.reset()):"salesAdd"==t&&(e.showAddSales=!1,e.$refs.salesForm.reset())}},data:function(){return{select:[],disabled:{addChannel:!1,editChannel:!1,sales:!1},channel_id:"",channel_name:"",achievement_type:[{type:1,value:"叠加目标"},{type:2,value:"分解目标"}],subWidth:{table:{paddingLeft:"0px"},td2:{width:"0px"},td3:{width:"0px"},td4:{width:"0px"},td5:{width:"0px"},td6:{width:"0px"},td7:{width:"0px"},td8:{width:"0px"}},showAdd:!1,showEdit:!1,showAddSales:!1,saliesLists:[{username:"",uid:""}],chips:[],addItem:{channel_name:"",channel_info:"",qr_code_info:"",type:"",chan_pfm_obj:"",chan_doc_num:""},editItem:{channel_name:"",channel_info:"",qr_code_info:"",type:"",chan_pfm_obj:"",chan_doc_num:""},theader:[{align:"left",value:"",sortable:!1},{align:"left",value:"channel_name",sortable:!1},{align:"left",value:"",sortable:!1},{align:"left",value:"qr_code_info",sortable:!1},{align:"left",value:"url_code",sortable:!1},{align:"right",value:"chan_doc_num",sortable:!1},{align:"right",value:"chan_pfm_obj",sortable:!1},{align:"center",value:"",sortable:!1}],tdata:[]}}})}},[[55,0,2,1]]]);